<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/layout}"
      layout:fragment="content">
<head>
<meta charset="UTF-8">
<title>포장등록</title>
<link rel="stylesheet" href="https://uicdn.toast.com/grid/latest/tui-grid.css" />
	<style>
		#container {
			height: 1000px;
		}
		.search-bar {
			width: 780px;
			height: 250px;
			-webkit-box-shadow: 0 0 0 0 rgba(90, 113, 208, 0), 0 4px 16px 0 rgba(167, 175, 183, 0);
			display: inline-block;
			flex-direction:row;
		}

		.order-list {
			width: 780px;
			height: 778px;
		}
		.order-info{
			flex-grow: 0 !important;
			margin-top: 0;
			margin-left: 30px;
			width: 900px !important;
			height: 1030px;
		}
		.search-unit {
			display: flex;
			margin-bottom:5px;
		}
		.search-unit div {
			display: inline-block;
		}
		.search-bar > div {
		    display: inline-block;
		    vertical-align: top; /* 정렬 보정 */
		}
		.search-bar div:nth-of-type(1) {
			padding-left:10px;
			width: 300px;
		}
		.read-bar div:nth-of-type(1) {
			margin-left: 40px;
		}
		.read-bar div {
			margin-top: 10px;
		}
		.read-bar input[type=text] {
			width: 180px !important;
		}
		.read-bar input[type=text]:nth-of-type(1) {
			margin-right: 30px;
		}
		.read-bar span::nth-of-type(2) {
			margin-left: 20px;
		}
		.search-bar div:nth-of-type(2) {
			padding-left:10px;
			width: 410px;
		}
		.search-unit span {
			font-size: smaller;
			line-height: 2.5;
			width: 67px;
		}
		.search-bar div:nth-of-type(1) input{
			margin-left: 10px;
		}
		.search-bar div input[type=text] {
			width: 140px;
		}
		.search-bar select {
		    margin-left: 10px;
			width: 140px;
			border: 1px solid #dee2e6;
		    font-weight: 400;
		    font-size: 0.875rem;
		    border-radius: 4px;
		    height: 2rem;
		}
		input[type=date] {
			width: 140px;
		}
		.search-bar input[type=number] {
			width: 140px;
		}
		.search-bar b {
			display: block;
			margin-bottom:5px;
		}
		.btn-secondary {
			background-color: #b1b1b1;
		}
		.search-bar .btn-section{
			width: 390px !important;
			display: flex;
			justify-content: right;
			margin-top: 30px;
			margin-bottom: 10px;
		}
		.search-bar .btn-section button{
			margin-right: 10px;
		}
		.info-section>div{
			width: 600px;
		}
		.completeBtn-section {
			width: 807px;
			display: flex;
			justify-content: center;
		}
		.completeBtn-section button {
			margin: 10px;
		}
		.dash {
			line-height: 1.9;
			margin-left: 2px;
			margin-right: 2px;
		}
		/*여기까지 거의 공용*/
		.read-bar {
			width: 807px;
			height: 130px;
			margin-bottom: 20px !important;
		}
		.info-unit span{
			width: 100px;
		}
		.read-memo {
			width: 500px;
			height: 100px;
		}
		.memo-span {
			padding-left: 10px;
			margin-right: 20px;
		}
		.order-info b {
			margin-bottom: 20px;
		}
		.summary-info {
			margin-top: 30px;
		}
		#productListGrid {
			width: 807px;
		}
		.packing-info {
			
			width: 807px;
			border: 1px solid #eeeeee;
			border-radius: 13px;
			flex-grow: 0!important
		}
		.storage select {
			width: 150px;
		}
		.storage {
			border-top-left-radius: 13px;
    		border-top-right-radius: 13px;
			display: flex;
			width: 805px;
			border-bottom: 1px solid #eeeeee;
		}
		.storage span {
		    padding-top: 4px;
			width: 100px;
		}
		.storage {
			background-color: #f9f9f9;
			padding: 10px;
		}
		.packing-table {
			width: 805px;
		}
		.packing-table table tr{
			background-color: #f9f9f9 !important;
		}
		.packing-table table td{
			border: 1px solid #eeeeee !important;
		}
		.bg-custom-gray {
			background-color: #f9f9f9 !important;
			text-align: center;
		}
		.chargerInfo-section {
			display: flex;
			width: 200px !important;
			position: relative;
			left: 40%;
		}
		.chargerInfo-section input {
			text-align: center;
			width: 130px;
		}
	</style>
</head>
<body>
	<h3 class="fs-3 fw-bold">| 포장등록</h3>
	<div id="container row" style="display: flex;">
		<div>			
			<div class="p-3 mb-2 bg-secondary text-dark card search-bar">
				
				<b>검색</b>
									
				<div>
					<span class="search-unit">
						<span>납품코드</span>
						<input type="text" class="form-control search-delivery-code"> 
					</span>
					<span class="search-unit">
						<span>제품코드</span>
						<input type="text" class="form-control search-product-code">
					</span>
					<span class="search-unit">
						<span>제품명</span>
						<input type="text" class="form-control search-product-name"> 
					</span>
					<span class="search-unit">
						<span>담당자코드</span>
						<input type="text" class="form-control search-delivery-chargerCode">
					</span>
					<span class="search-unit">
						<span>담당자</span>
						<input type="text" class="form-control search-delivery-charger"> 
					</span>
				</div>
				
				<!-- 검색조건2: 발주일, 납기일 -->
				<div>
					
					<span class="search-unit">
						<span>발주일</span>
						<input type="date" class="form-control search-date-start"> <b class="dash">-</b> 
						<input type="date" class="form-control search-date-end">
					</span>
					<span class="search-unit">
						<span>납기일</span>
						<input type="date" class="form-control search-dedt-start"> <b class="dash">-</b> 
						<input type="date" class="form-control search-dedt-end">
					</span>

					<div class="btn-section">						
						<button class="btn btn-warning mag-glass-btn" onclick="searchOrderList()"><i class="fa-solid fa-magnifying-glass icon-left" style="color: #ffffff;"></i></button>
						<button class="btn btn-secondary mag-glass-btn" onclick="resetCondition()"><i class="fa-solid fa-repeat icon-left" style="color: #ffffff;"></i></button>
					</div>
				</div>
			</div>
			<div class="card card-body mt-3 order-list">
				<b>목록</b>
				<!-- 검색결과 목록 -->
				<div id="deliveryListGrid"></div>
			</div>
		</div>
		
		
		<div class="col card card-body order-info">		
			<b>제품 목록</b>
			<!-- 제품 리스트 -->
			<div id="productListGrid"></div>
			<!-- 제품 상세 수량 피벗 -->
			<div id="productDetails"></div>
			<!-- 출고 로트 -->
			<div id="productLot"></div>
			
			<b class="mt-5 mb-0">포장 정보</b>
			<div class="packing-info">
				<div class="storage">
					<span>출고창고</span>
					<select class=" form-control">
						<option value=""></option>
					</select>
					<span class="chargerInfo-section">					
						<span>작성자 : </span>
						<input type="text" class="form-control chargerName" readOnly>
					</span>
				</div>
				
				<table class="table packing-table">
					<tbody>
						<tr class="bg-custom-gray">
							<td>상자사이즈</td>
							<td>대</td>
							<td>중</td>
							<td>소</td>
							<td>합계</td>
						</tr>
						<tr class="boxQy">
							<td>출고수량</td>
							<td><input type="number" class="form-control big-box"></td>
							<td><input type="number" class="form-control middle-box"></td>
							<td><input type="number" class="form-control small-box"></td>
							<td><input type="number" class="form-control boxQySum" readOnly></td>
						</tr>
						
					</tbody>
				</table>
			</div>
			
			<div class="completeBtn-section">
				<!-- 배송 번호 -->
				<input type="hidden" class="deliveryCode">
				<button type="button" class="btn btn-success openIsRegist" data-bs-toggle="modal">
		    		등록
		  		</button>
				<button class="btn btn-outline-secondary resetBtn">초기화</button>
				
			</div>
		</div>
	</div>
	
		<!-- 등록 확인 모달 -->
	<div class="modal fade" id="registModal" tabindex="-1"
		aria-labelledby="exampleModalLabel" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header" style="height: 20px;">
					<h5 class="modal-title" id="exampleModalLabel"
						style="font-size: 15px;">등록 확인</h5>
				</div>
				<div class="modal-body"
					style="text-align: center; padding: 44px; padding-bottom: 10px;">
					<div>
						<img src="/images/modal/regist.png" alt="등록확인이미지"
							style="width: 84px; height: 84px;">
					</div>
					<div>
						<p style="margin-top: 12px; font-size: 21px; font-weight: bold;">알림</p>
						<p>내용을 등록하시겠습니까?</p>
					</div>
				</div>
				<div class="modal-footer regist"
					style="display: flex; justify-content: center; border-top: none; padding-bottom: 45px;">
					<!-- -->
					<button type="button"
						class="btn btn-outline-success packingRegistBtn"
						data-bs-dismiss="modal">등록</button>
					<button type="button" class="btn btn-outline-secondary denyBtn"
						data-bs-dismiss="modal">취소</button>
				</div>
			</div>
		</div>
	</div>
	
	<script>
		addEventListener("DOMContentLoaded", () => {
			setTimeout(() => {
				//바로넣으니 undifined로 나와서 살짝 지연해서 입력.
				document.querySelector(".chargerName").value = session_user_name;
			}, "300");
			
		});
	
		//상자 정보 객체
		let boxInfo = null;
		
		fetch(`/delivery/packingSTDInfo`)
		.then(rep => rep.json())
		.then(res => { 
			console.log(res);
			let html = ''
			for(let i=0; i<res.storage.length; i++) {
				html += '<option value="' + res.storage[i] +'">'+ res.storage[i] +'</option>';
			}
			document.querySelector(".storage select").innerHTML = html;
			
			//박스 정보
			boxInfo = res.box;
		})
		
			    //출고목록 검색 함수
        function searchOrderList() {
        	deliveryListGrid.readData(1, {
        		deliveryCode: document.querySelector('.search-delivery-code').value,
        		deliveryCharger: document.querySelector('.search-delivery-charger').value,
        		deliveryChargerCode: document.querySelector('.search-delivery-chargerCode').value,
        		orderDateStart: document.querySelector('.search-date-start').value,
        		orderDateEnd: document.querySelector('.search-date-end').value,
        		dedtStart: document.querySelector('.search-dedt-start').value,
        		dedtEnd: document.querySelector('.search-dedt-end').value,
        		productCode: document.querySelector('.search-product-code').value,
        		productName: document.querySelector('.search-product-name').value,
        		deliveryStatus: 'DS01'
        	}, false);	//안에 값 넣으면 됨 파라미터 세개 (1:몊번째 페이지 불러올 것인가, 2:검색조건, 3:true=기존데이터 초기화)
        }
		
		//출고 목록
		const dataSource = {
		  	      api: {
		  	          readData: { url: '/delivery/getPackingList' , method: 'GET' },
		  	        },
		  	      contentType: 'application/json',
		  	    };  

        const deliveryListGrid = new Grid({
            el: document.getElementById('deliveryListGrid'),
            rowHeaders: ['rowNum'],
            pageOptions: {
                useClient: false,    //데이터를 한번에 다 가져옴. 나중에 false로 할 예정
                perPage: 15
            },
            bodyHeight: 619,
            columnOptions: {
  	          resizable: true
  	      	},
			scrollY: true,
			scrollX: false,
            columns: [
				{ header: "납품코드", name: "deliveryCode"},
				{ header: "업체코드", name: "companyCode"},
				{ header: "업체명", name: "company"},
				{ header: "납기일", name: "dedt"},
				{ header: "요약", name: "summary"},			
				{ header: "출고등록일", name: "registDate"},
				{ header: "비고", name: "remark", hidden: true},
				{ header: "출고담당자", name: "deliveryChargerCode", hidden: true},
				{ header: "출고담당자코드", name: "deliveryCharger", hidden: true},
				
            ],
            data: dataSource,
			showDummyRows: true	//더미로우 추가
        });
		
		//제품 목록
		const productListGrid = new Grid({
			el: document.getElementById('productListGrid'),
			bodyHeight: 150,
			width: 807,
			scrollY: true,
			scrollX: false,
			rowHeaders: ['rowNum'],
			columns: [
				{ header: "출고번호", name: "deliveryCode", hidden: true},
				{ header: "제품코드", name: "productCode"},
				{ header: "제품명", name: "productName"},
				{ header: "출고량합계", name: "qySum"},
				{ header: "부피", name: "vl", hidden: true},
			]
		});
		
		//제품 출고 상세
		const productDetails = new Grid({
			el: document.getElementById('productDetails'),
			scrollY: true,
		    scrollX: true,
		    width: 807,
		    bodyHeight: 200,
		    header: {
		        	height: 70,
		            complexColumns: [
		              {
		                header: 'S',
		                name: 'stest',
		                childNames: ['sizeS', 's']
		              },
		              {
			             header: 'M',
			             name: 'mtest',
			             childNames: ['sizeM', 'm']
			          },
			          {
				         header: 'L',
				         name: 'ltest',
				         childNames: ['sizeL', 'l']
				      },
				      {
					      header: 'XL',
					      name: 'xltest',
					      childNames: ['sizeXl', 'xl']
					  }
		             ]},
		        columns: [
		            { header: "색상/사이즈", name: "productColor", align: "center", width:80 },
		            { header: "출고수량", name: "sizeS", align: "center", editor: "text"},
		            { header: "출고수량", name: "sizeM", align: "center", editor: "text"},
		            { header: "출고수량", name: "sizeL", align: "center", editor: "text"},
		            { header: "출고수량", name: "sizeXl", align: "center", editor: "text"},
		        ],
			  columnOptions: {
			        frozenCount: 1,
			        frozenBorderWidth: 1,
			        minWidth: 150
			      }
		  	  });  
		
		//출고 로트 수량
		const productLot = new Grid({
			el: document.getElementById('productLot'),
			bodyHeight: 100,
			width: 807,
			scrollY: true,
			scrollX: false,
			columns: [
				{ header: "로트", name: "productLot"},
				{ header: "출고수량", name: "deliveryQy"}
			]
		});
		
		

	    
        //출고건 선택 저장 변수
		let lastClicked = null;
        
        //제품 부피 총합 변수
	    let allProductVlSum = 0;
	    
	  	//박스 수량
		let lBox = 0;
		let mBox = 0;
		let sBox = 0;
		let totalBoxQy = 0;
		
        deliveryListGrid.on('focusChange', ev => {
			deliveryListGrid.removeRowClassName(lastClicked, 'bg-blue'); // 이전 선택 행 배경색 삭제
			deliveryListGrid.addRowClassName(ev.rowKey, 'bg-blue'); // 선택된 행 배경색 추가
			lastClicked = ev.rowKey; // 선택된 행 기억
			
			//그리드 초기화
			productDetails.clear();
			productLot.clear();
			
			//상자 수량 기본값
			document.querySelector(".big-box").value = 0;
			document.querySelector(".middle-box").value = 0;
			document.querySelector(".small-box").value = 0;
			
			//선택행 데이터
			let data = deliveryListGrid.getRow(ev.rowKey);
			console.log('출고건 선택:', data);
			
			//배송번호
			document.querySelector(".deliveryCode").value = data.deliveryCode;			
			
			fetch(`/delivery/deliveryProductList?deliveryCode=${data.deliveryCode}`)
    		.then(rep => rep.json())
    		.then(res => { 
    			console.log('출고건 선택 통신 결과: ', res);
    			productListGrid.resetData(res);
    			
    			//부피 총 합을 구할 변수
    			let vlSum = 0;
    			//부피 총합 구하기
    			for(let i=0; i<res.length; i++) {
    				vlSum += res[i].vl * res[i].qySum;
    			}
    			allProductVlSum = vlSum; //초기화시 사용할 변수에 값 저장

    			console.log('vlSum', vlSum);
   				for(let i=0; i<boxInfo.length; i++) {
   					//console.log("반복문 시작");
   					//while문 반복 변수
   					let roopVal = true;
   					
   					
   					//제품 전체 사이즈가 박스 사이즈보다 클경우 내부 내용 실행
   					if( vlSum - boxInfo[i].boxVl > 0) {   		
   						//console.log("반복문 내부 제품 전체 사이즈가 박스 사이즈보다 클 경우 내부 내용 실행");
	   					while(roopVal) {
	   						//console.log("반복문 내부 while문 내부 박스 사이즈에 vlSum을 계속 뺌");
	   						//console.log("빼고 있는 상자 사이즈: ", boxInfo[i].boxVl);
							//제품 총 부피에서 상자 크기를 계속 뺌
	   						vlSum -= boxInfo[i].boxVl;
							
							//계속 빼서 제품 총 부피가 0보다 작을때 
	   						if(vlSum < 0) {
	   							//console.log("반복문 내부 while문 내부 vlSum이 0보다 작아졌음");
	   							//console.log('i의 값', i);
	   							//roopVal = false;
	   							switch(i) {
	   								case 0 : //console.log('case1실행', Math.floor(allProductVlSum / boxInfo[i].boxVl));
	   										 lBox = Math.floor(allProductVlSum / boxInfo[i].boxVl);
	   										 document.querySelector(".big-box").value = lBox;
	   										 vlSum = allProductVlSum % boxInfo[i].boxVl;
	   										 roopVal = false;
	   									break;
	   								case 1 : //console.log('case2실행', Math.floor(vlSum / boxInfo[i].boxVl));
	   										 mBox = Math.floor(allProductVlSum / boxInfo[i].boxVl);
	   										 document.querySelector(".middle-box").value = mBox;
	   										 vlSum = (allProductVlSum / boxInfo[i-1].boxVl) % boxInfo[i].boxVl;
										     roopVal = false;
										break;
	   								case 2 : //console.log('case3실행', Math.floor(vlSum / boxInfo[i].boxVl));
	   										 sBox = Math.ceil(allProductVlSum / boxInfo[i].boxVl);
	   										 document.querySelector(".small-box").value = sBox;
			   								 vlSum = ((allProductVlSum / boxInfo[i-2].boxVl) / boxInfo[i-1].boxVl) % boxInfo[i].boxVl;
										     roopVal = false;
										break;
	   						        default:
	   						            break;	
	   							}
	   							break;
	   						}
							//console.log('roopVal', roopVal);
	   					}
   					}
   				}
   				lBox = document.querySelector(".big-box").value;
   				mBox = document.querySelector(".middle-box").value;
   				sBox = document.querySelector(".small-box").value;
   				//박스 수량 업데이트
   				document.querySelector(".boxQySum").value = Number(document.querySelector(".big-box").value) + Number(document.querySelector(".middle-box").value) + Number(document.querySelector(".small-box").value);
  				
    		})
        })
        
        //제품 선택 저장 변수
        let lastClickedProduct = null;
        //deliveryProductDetails
        productListGrid.on('focusChange', ev => {
        	productListGrid.removeRowClassName(lastClickedProduct, 'bg-blue'); // 이전 선택 행 배경색 삭제
        	productListGrid.addRowClassName(ev.rowKey, 'bg-blue'); // 선택된 행 배경색 추가
        	lastClickedProduct = ev.rowKey; // 선택된 행 기억
			let data = productListGrid.getRow(ev.rowKey);
			console.log('제품 선택:', data);
			//deliveryCode, productCode
			
			fetch(`/delivery/deliveryProductDetails?deliveryCode=${data.deliveryCode}&productCode=${data.productCode}`)
    			.then(rep => rep.json())
    			.then(res => { 
    				console.log('제품 사이즈 가져오기 통신 결과: ', res);
    				//사이즈 정보 담을 배열
    	            let products = [];
    	    		//사이즈 컬럼(그리드 헤더 - 제일 위)
    	    		let size = [];
    	            //색상, 사이즈 컬럼
    				let color = [{ header: "색상/사이즈", name: "PRODUCT_COLOR", align: "center", minWidth: 80 }];
    	            
    	            let deliveryDetails = res;
    	            for(let i=0; i<deliveryDetails.optionList.length; i++) {
    	            	let sizeCode = deliveryDetails.optionList[i].showSize;
    	            	
    	            	size.push({
    		                header: sizeCode,
    		                name: 'DE' + sizeCode,
    		                minWidth: 150
    		             })
    		             
    		             color.push({ header: sizeCode, name: 'DE'+sizeCode, align: "right", minWidth: 100, formatter:(row)=>numberFormatter(row.value)})
    	            }
    	            //이 작업없으면 중복해서 계속 들어감. 한번만 들어가도록 하기
    	            for(let i=0; i<deliveryDetails.qyList.length; i++) {    
    	            	//선택한 제품코드와 객체 배열 안에 있는 제품 코드가 같으면 배열에 넣고, 화면에 출력함.
    	            	if(data.productCode == deliveryDetails.qyList[i].PRODUCT_CODE) {	
    	            		//서버에서 가져온 데이터 + 제품 이름 같이 넣었음.
    						products.push({...deliveryDetails.qyList[i], productName : data.productName, deliveryCode: data.deliveryCode});
    						
    	            	}
    	            }
    				
    				productDetails.setColumns(color);
    				productDetails.resetData(products);
    			})
			
        })
        
        //제품 상세 선택 저장 변수
        let lastClickedProductDetail = null;
        productDetails.on('focusChange', ev => {
        	productDetails.removeRowClassName(lastClickedProductDetail, 'bg-blue'); // 이전 선택 행 배경색 삭제
        	productDetails.addRowClassName(ev.rowKey, 'bg-blue'); // 선택된 행 배경색 추가
        	lastClickedProductDetail = ev.rowKey; // 선택된 행 기억
			let data = productDetails.getRow(ev.rowKey);
			console.log('제품 상세 선택:', data);
			console.log("선택한 컬럼(검색할 사이즈)",ev.columnName);
			
			//사용자가 선택한 사이즈
			let targetSize = getSizeCommonCode(ev.columnName.replace("DE", ""));
			
			//출고번호(data.deliveryCode), 제품코드(data.PRODUCT_CODE), 색상(data.PRODUCT_COLOR), 사이즈(ev.columnName)
			
			
			fetch(`/delivery/deliveryLot?deliveryCode=${data.deliveryCode}&productCode=${data.PRODUCT_CODE}&productColor=${data.PRODUCT_COLOR}&productSize=${targetSize}`)
    			.then(rep => rep.json())
    			.then(res => {
    				console.log(res);
    				productLot.resetData(res);
    			})
			
        })
        
        document.querySelectorAll(".boxQy input").forEach(ele => 
        	ele.addEventListener("change", (event) => {
        		console.log('작동');
        		//상자 총 합계 화면에 출력
   				document.querySelector(".boxQySum").value = Number(document.querySelector(".big-box").value) + Number(document.querySelector(".middle-box").value) + Number(document.querySelector(".small-box").value);
        	})
        );
        /*
        DELIVERY_CODE     
		BOX_SIZE   
		QY  
		
        PACKING_NO    packing_seq.nextVal                     
		RGSDE                 
		UPDDE               
		CHARGER_CODE      
		CHARGER_NAME
		*/
		
		//서버로 보내기
		document.querySelector('.openIsRegist').addEventListener("click", () => {
			let registModal = new bootstrap.Modal(document.getElementById("registModal"));
    		registModal.show();

		})
		
		document.querySelector('.packingRegistBtn').addEventListener('click', () => {
			//상자 정보 객체
			let boxQyArr = [{size: "대", qy: Number(lBox)}, 
				 {size: "중", qy: Number(mBox)}, 
				 {size: "소", qy: Number(sBox)}];
			
			//서버로 보낼 객체 배열
			let sendArr = [];
			
			//객체 배열 만들기
			for(let i=0; i<3; i++) {
				if(boxQyArr[i] != 0) {					
					sendArr.push({boxSize: boxQyArr[i].size, 
								  deliveryCode: document.querySelector(".deliveryCode").value,
								  boxQy : boxQyArr[i].qy,
								  storageName : document.querySelector(".storage select").value,
								  chargerName : session_user_name,
								  chargerCode : session_user_code
									  });
				}
			}	
			
			console.log("서버 보내기 전 배열", sendArr);
			//포장등록
			const response = fetch('/delivery/packingInsert', {
                method: 'post',
                headers: {
                    "Content-Type": "application/json",
                    ...headers
                },
                body: JSON.stringify(sendArr)
            })
            .then(res => res.json())
            .then(result => {
            	console.log('서버 통신결과:', result);
            	if(result == 'success') {
						loading(400);
						successToast("포장등록이 완료되었습니다.");
            		}
            	})
		}) 
        
		//입력값 초기화
        document.querySelector('.resetBtn').addEventListener("click", () => {
        	console.log('작동');
        	document.querySelector(".big-box").value = lBox;
        	document.querySelector(".middle-box").value = mBox;
        	document.querySelector(".small-box").value = sBox;
        	document.querySelector(".boxQySum").value = totalBoxQy;
        })
	</script>
</body>
</html>